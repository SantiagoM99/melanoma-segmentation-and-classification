
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Melanoma Segmentation Evaluation and Visualization (melanoma_segmentation.results) &#8212; Melanoma Segmentation 1.4.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="_static/documentation_options.js?v=350a9c04"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'melanoma_segmentation.results';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Melanoma Segmentation Util Functions (melanoma_segmentation.utils)" href="melanoma_segmentation.utils.html" />
    <link rel="prev" title="Melanoma Segmentation models (melanoma_segmentation.models)" href="melanoma_segmentation.models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Melanoma Segmentation 1.4.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="melanoma_segmentation.html">
    Melanoma Segmentation (melanoma_segmentation)
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="melanoma_segmentation.html">
    Melanoma Segmentation (melanoma_segmentation)
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="melanoma_segmentation.configs.html">Melanoma Segmentation Configurations (melanoma_segmentation.configs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="melanoma_segmentation.datasets.html">Melanoma Segmentation Dataset handling (melanoma_segmentation.datasets)</a></li>
<li class="toctree-l1"><a class="reference internal" href="melanoma_segmentation.models.html">Melanoma Segmentation models (melanoma_segmentation.models)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Melanoma Segmentation Evaluation and Visualization (melanoma_segmentation.results)</a></li>
<li class="toctree-l1"><a class="reference internal" href="melanoma_segmentation.utils.html">Melanoma Segmentation Util Functions (melanoma_segmentation.utils)</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="melanoma_segmentation.html" class="nav-link">Melanoma Segmentation (melanoma_segmentation)</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Melanoma Segmentation Evaluation and Visualization (melanoma_segmentation.results)</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="melanoma-segmentation-evaluation-and-visualization-melanoma-segmentation-results">
<h1>Melanoma Segmentation Evaluation and Visualization (melanoma_segmentation.results)<a class="headerlink" href="#melanoma-segmentation-evaluation-and-visualization-melanoma-segmentation-results" title="Link to this heading">#</a></h1>
<p>This subpackage provides tools for evaluating and visualizing the performance of segmentation models. It includes utilities for calculating metrics, identifying performance extremes, and creating visual overlays of segmentation results.</p>
<section id="model-evaluation-utility-for-image-segmentation">
<h2>Model Evaluation Utility for Image Segmentation<a class="headerlink" href="#model-evaluation-utility-for-image-segmentation" title="Link to this heading">#</a></h2>
<p>This module provides an <cite>Evaluator</cite> class for assessing the performance of segmentation models using metrics such as
Dice coefficient, IoU, accuracy, and recall. It also tracks the images with the highest and lowest scores for each metric.</p>
<section id="class">
<h3>Class<a class="headerlink" href="#class" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Evaluator</strong>: Evaluates a PyTorch model on a test dataset using common segmentation metrics.</p></li>
</ul>
</section>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Link to this heading">#</a></h3>
<p>To evaluate a trained segmentation model:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">melanoma_segmentation.results.evaluator</span> <span class="kn">import</span> <span class="n">Evaluator</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Assume `model` is a trained PyTorch segmentation model and `test_dataset` is a dataset for evaluation.</span>
<span class="n">test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">evaluator</span> <span class="o">=</span> <span class="n">Evaluator</span><span class="p">(</span><span class="n">model_path</span><span class="o">=</span><span class="s2">&quot;path_to_model.pth&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">test_dataloader</span><span class="o">=</span><span class="n">test_loader</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>

<span class="n">avg_dice</span><span class="p">,</span> <span class="n">avg_iou</span><span class="p">,</span> <span class="n">avg_accuracy</span><span class="p">,</span> <span class="n">avg_recall</span><span class="p">,</span> <span class="n">max_indices</span><span class="p">,</span> <span class="n">min_indices</span> <span class="o">=</span> <span class="n">evaluator</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Dice: </span><span class="si">{</span><span class="n">avg_dice</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average IoU: </span><span class="si">{</span><span class="n">avg_iou</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Accuracy: </span><span class="si">{</span><span class="n">avg_accuracy</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average Recall: </span><span class="si">{</span><span class="n">avg_recall</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<span class="target" id="module-melanoma_segmentation.results.evaluator"></span><dl class="py class">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">melanoma_segmentation.results.evaluator.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to evaluate a segmentation model using metrics such as Dice coefficient, IoU, accuracy, and recall.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.model" title="Link to this definition">#</a></dt>
<dd><p>The PyTorch model to evaluate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.test_dataloader">
<span class="sig-name descname"><span class="pre">test_dataloader</span></span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.test_dataloader" title="Link to this definition">#</a></dt>
<dd><p>The DataLoader providing test images and masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.device" title="Link to this definition">#</a></dt>
<dd><p>The device to run the evaluation on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.evaluator.Evaluator.accuracy" title="melanoma_segmentation.results.evaluator.Evaluator.accuracy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">accuracy</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the accuracy between predicted and target masks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#melanoma_segmentation.results.evaluator.Evaluator.dice_coefficient" title="melanoma_segmentation.results.evaluator.Evaluator.dice_coefficient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dice_coefficient</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the Dice coefficient between predicted and target masks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.evaluator.Evaluator.evaluate" title="melanoma_segmentation.results.evaluator.Evaluator.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>()</p></td>
<td><p>Evaluate the model on the test dataset using Dice, IoU, accuracy, and recall.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#melanoma_segmentation.results.evaluator.Evaluator.iou_score" title="melanoma_segmentation.results.evaluator.Evaluator.iou_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iou_score</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the Intersection over Union (IoU) between predicted and target masks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.evaluator.Evaluator.recall" title="melanoma_segmentation.results.evaluator.Evaluator.recall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recall</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the recall between predicted and target masks.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.accuracy" title="Link to this definition">#</a></dt>
<dd><p>Compute the accuracy between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Accuracy score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.dice_coefficient">
<span class="sig-name descname"><span class="pre">dice_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.dice_coefficient" title="Link to this definition">#</a></dt>
<dd><p>Compute the Dice coefficient between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dice coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on the test dataset using Dice, IoU, accuracy, and recall.</p>
<p>Also tracks the indices of the images with the highest and lowest scores for each metric.</p>
<p>For each metric, the indices are stored in the following order:
- Dice: max_indices[0], min_indices[0]
- IoU: max_indices[1], min_indices[1]
- Accuracy: max_indices[2], min_indices[2]
- Recall: max_indices[3], min_indices[3]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing:
- avg_dice (float): Average Dice coefficient.
- avg_iou (float): Average IoU score.
- avg_accuracy (float): Average accuracy score.
- avg_recall (float): Average recall score.
- max_indices (list): Indices of the images with the highest Dice, IoU, accuracy, and recall.
- min_indices (list): Indices of the images with the lowest Dice, IoU, accuracy, and recall.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.iou_score">
<span class="sig-name descname"><span class="pre">iou_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.iou_score" title="Link to this definition">#</a></dt>
<dd><p>Compute the Intersection over Union (IoU) between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IoU score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.evaluator.Evaluator.recall">
<span class="sig-name descname"><span class="pre">recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.evaluator.Evaluator.recall" title="Link to this definition">#</a></dt>
<dd><p>Compute the recall between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recall score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
<section id="visualization-utility-for-segmentation-models">
<h2>Visualization Utility for Segmentation Models<a class="headerlink" href="#visualization-utility-for-segmentation-models" title="Link to this heading">#</a></h2>
<p>This module provides functions for visualizing segmentation results, including the input image, ground truth mask,
and model predictions. It also supports overlaying masks on images with customizable colors and transparency.</p>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>overlay_mask</strong>: Overlays a binary mask on an image with a specified color and transparency.</p></li>
<li><p><strong>plot_img_mask_pred</strong>: Visualizes the image, ground truth mask, and optionally the model’s prediction.</p></li>
</ul>
</section>
<section id="id1">
<h3>Usage<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<p>To visualize an image with its ground truth and predicted mask:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">melanoma_segmentation.results.plots</span> <span class="kn">import</span> <span class="n">plot_img_mask_pred</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>

<span class="c1"># Assume `dataset` is a PyTorch dataset containing images and masks, and `model` is a trained segmentation model.</span>
<span class="n">plot_img_mask_pred</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">dataset</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">plot_pred</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To overlay a mask on an image:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">melanoma_segmentation.results.plots</span> <span class="kn">import</span> <span class="n">overlay_mask</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Example usage</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="mi">256</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Red color</span>
<span class="n">overlaid_image</span> <span class="o">=</span> <span class="n">overlay_mask</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">mask</span><span class="p">,</span> <span class="n">color</span><span class="p">)</span>
</pre></div>
</div>
<span class="target" id="module-melanoma_segmentation.results.plots"></span><dl class="py function">
<dt class="sig sig-object py" id="melanoma_segmentation.results.plots.overlay_mask">
<span class="sig-prename descclassname"><span class="pre">melanoma_segmentation.results.plots.</span></span><span class="sig-name descname"><span class="pre">overlay_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">border_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.plots.overlay_mask" title="Link to this definition">#</a></dt>
<dd><p>Overlay a mask on an image with a given color and transparency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<em>numpy.ndarray</em>) – Input image.</p></li>
<li><p><strong>mask</strong> (<em>numpy.ndarray</em>) – Binary mask to overlay.</p></li>
<li><p><strong>color</strong> (<em>list</em>) – RGB color to use for the overlay.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Transparency of the overlay. Default is 0.5.</p></li>
<li><p><strong>border_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only the border of the mask will be shown. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Image with the overlay applied</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="melanoma_segmentation.results.plots.plot_img_mask_pred">
<span class="sig-prename descclassname"><span class="pre">melanoma_segmentation.results.plots.</span></span><span class="sig-name descname"><span class="pre">plot_img_mask_pred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.plots.plot_img_mask_pred" title="Link to this definition">#</a></dt>
<dd><p>Plot the image, ground truth mask, and prediction from a given dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – Dataset containing images and masks in the format (image, mask).</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the image to plot. If not provided, a random index is selected. Default is None.</p></li>
<li><p><strong>plot_pred</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to plot the model’s prediction. Default is False.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em><em>, </em><em>optional</em>) – The model used for generating predictions. Required if <cite>plot_pred</cite> is True. Default is None.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to use for generating predictions (e.g., “cpu” or “cuda”). Default is “cpu”.</p></li>
<li><p><strong>comparison</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only the image with both masks (ground truth and predicted) as borders will be shown. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="module-melanoma_segmentation.results">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-melanoma_segmentation.results" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">melanoma_segmentation.results.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dataloader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to evaluate a segmentation model using metrics such as Dice coefficient, IoU, accuracy, and recall.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.model" title="Link to this definition">#</a></dt>
<dd><p>The PyTorch model to evaluate.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>nn.Module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.test_dataloader">
<span class="sig-name descname"><span class="pre">test_dataloader</span></span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.test_dataloader" title="Link to this definition">#</a></dt>
<dd><p>The DataLoader providing test images and masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.device">
<span class="sig-name descname"><span class="pre">device</span></span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.device" title="Link to this definition">#</a></dt>
<dd><p>The device to run the evaluation on.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>torch.device</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.Evaluator.accuracy" title="melanoma_segmentation.results.Evaluator.accuracy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">accuracy</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the accuracy between predicted and target masks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#melanoma_segmentation.results.Evaluator.dice_coefficient" title="melanoma_segmentation.results.Evaluator.dice_coefficient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dice_coefficient</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the Dice coefficient between predicted and target masks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.Evaluator.evaluate" title="melanoma_segmentation.results.Evaluator.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>()</p></td>
<td><p>Evaluate the model on the test dataset using Dice, IoU, accuracy, and recall.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#melanoma_segmentation.results.Evaluator.iou_score" title="melanoma_segmentation.results.Evaluator.iou_score"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iou_score</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the Intersection over Union (IoU) between predicted and target masks.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#melanoma_segmentation.results.Evaluator.recall" title="melanoma_segmentation.results.Evaluator.recall"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recall</span></code></a>(preds, targets[, smooth])</p></td>
<td><p>Compute the recall between predicted and target masks.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.accuracy">
<span class="sig-name descname"><span class="pre">accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.accuracy" title="Link to this definition">#</a></dt>
<dd><p>Compute the accuracy between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Accuracy score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.dice_coefficient">
<span class="sig-name descname"><span class="pre">dice_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.dice_coefficient" title="Link to this definition">#</a></dt>
<dd><p>Compute the Dice coefficient between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dice coefficient.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.evaluate" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the model on the test dataset using Dice, IoU, accuracy, and recall.</p>
<p>Also tracks the indices of the images with the highest and lowest scores for each metric.</p>
<p>For each metric, the indices are stored in the following order:
- Dice: max_indices[0], min_indices[0]
- IoU: max_indices[1], min_indices[1]
- Accuracy: max_indices[2], min_indices[2]
- Recall: max_indices[3], min_indices[3]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing:
- avg_dice (float): Average Dice coefficient.
- avg_iou (float): Average IoU score.
- avg_accuracy (float): Average accuracy score.
- avg_recall (float): Average recall score.
- max_indices (list): Indices of the images with the highest Dice, IoU, accuracy, and recall.
- min_indices (list): Indices of the images with the lowest Dice, IoU, accuracy, and recall.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.iou_score">
<span class="sig-name descname"><span class="pre">iou_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.iou_score" title="Link to this definition">#</a></dt>
<dd><p>Compute the Intersection over Union (IoU) between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IoU score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="melanoma_segmentation.results.Evaluator.recall">
<span class="sig-name descname"><span class="pre">recall</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.Evaluator.recall" title="Link to this definition">#</a></dt>
<dd><p>Compute the recall between predicted and target masks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>torch.Tensor</em>) – Predicted mask.</p></li>
<li><p><strong>targets</strong> (<em>torch.Tensor</em>) – Ground truth mask.</p></li>
<li><p><strong>smooth</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing constant to avoid division by zero. Defaults to 1e-6.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Recall score.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="melanoma_segmentation.results.plot_img_mask_pred">
<span class="sig-prename descclassname"><span class="pre">melanoma_segmentation.results.</span></span><span class="sig-name descname"><span class="pre">plot_img_mask_pred</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comparison</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#melanoma_segmentation.results.plot_img_mask_pred" title="Link to this definition">#</a></dt>
<dd><p>Plot the image, ground truth mask, and prediction from a given dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>torch.utils.data.Dataset</em>) – Dataset containing images and masks in the format (image, mask).</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index of the image to plot. If not provided, a random index is selected. Default is None.</p></li>
<li><p><strong>plot_pred</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to plot the model’s prediction. Default is False.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em><em>, </em><em>optional</em>) – The model used for generating predictions. Required if <cite>plot_pred</cite> is True. Default is None.</p></li>
<li><p><strong>device</strong> (<em>str</em><em>, </em><em>optional</em>) – Device to use for generating predictions (e.g., “cpu” or “cuda”). Default is “cpu”.</p></li>
<li><p><strong>comparison</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only the image with both masks (ground truth and predicted) as borders will be shown. Default is False.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="melanoma_segmentation.models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Melanoma Segmentation models (melanoma_segmentation.models)</p>
      </div>
    </a>
    <a class="right-next"
       href="melanoma_segmentation.utils.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Melanoma Segmentation Util Functions (melanoma_segmentation.utils)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#model-evaluation-utility-for-image-segmentation">Model Evaluation Utility for Image Segmentation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#class">Class</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator"><code class="docutils literal notranslate"><span class="pre">Evaluator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.model"><code class="docutils literal notranslate"><span class="pre">Evaluator.model</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.test_dataloader"><code class="docutils literal notranslate"><span class="pre">Evaluator.test_dataloader</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.device"><code class="docutils literal notranslate"><span class="pre">Evaluator.device</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.accuracy"><code class="docutils literal notranslate"><span class="pre">Evaluator.accuracy()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.dice_coefficient"><code class="docutils literal notranslate"><span class="pre">Evaluator.dice_coefficient()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.evaluate"><code class="docutils literal notranslate"><span class="pre">Evaluator.evaluate()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.iou_score"><code class="docutils literal notranslate"><span class="pre">Evaluator.iou_score()</span></code></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.evaluator.Evaluator.recall"><code class="docutils literal notranslate"><span class="pre">Evaluator.recall()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualization-utility-for-segmentation-models">Visualization Utility for Segmentation Models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#functions">Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Usage</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.plots.overlay_mask"><code class="docutils literal notranslate"><span class="pre">overlay_mask()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.plots.plot_img_mask_pred"><code class="docutils literal notranslate"><span class="pre">plot_img_mask_pred()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-melanoma_segmentation.results">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator"><code class="docutils literal notranslate"><span class="pre">Evaluator</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.model"><code class="docutils literal notranslate"><span class="pre">Evaluator.model</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.test_dataloader"><code class="docutils literal notranslate"><span class="pre">Evaluator.test_dataloader</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.device"><code class="docutils literal notranslate"><span class="pre">Evaluator.device</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.accuracy"><code class="docutils literal notranslate"><span class="pre">Evaluator.accuracy()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.dice_coefficient"><code class="docutils literal notranslate"><span class="pre">Evaluator.dice_coefficient()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.evaluate"><code class="docutils literal notranslate"><span class="pre">Evaluator.evaluate()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.iou_score"><code class="docutils literal notranslate"><span class="pre">Evaluator.iou_score()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.Evaluator.recall"><code class="docutils literal notranslate"><span class="pre">Evaluator.recall()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#melanoma_segmentation.results.plot_img_mask_pred"><code class="docutils literal notranslate"><span class="pre">plot_img_mask_pred()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="_sources/melanoma_segmentation.results.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Santiago Martínez Novoa.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>